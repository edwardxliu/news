"use strict";(()=>{var l=(e,t=!0)=>e.cloneNode(t);var y=async e=>{try{let t=await fetch(e);return t.ok?await t.json():[]}catch{return[]}},L=async e=>{try{let t=await fetch(e);return t.ok?await t.json():[]}catch{return[]}};var m=1,S=10,u=[],i=1;window.Webflow||(window.Webflow=[]);window.Webflow.push(async()=>{i=(await L(`http://metro-info.edwardxwliu.cn:5000/stat?per_page=${S}`)).tot_pages,d(m);let t=document.querySelector('[data-element="next-page"]'),n=document.querySelector('[data-element="previous-page"]');t&&t.addEventListener("click",()=>{d(m+1)}),n&&n.addEventListener("click",()=>{d(m-1)}),c(1,10)});var h=(e,t)=>{let n=l(t);return n&&(n.textContent=e.toString(),n.setAttribute("page-nav-index",e.toString())),n.addEventListener("click",()=>{n.disabled||d(e)}),n},c=async(e,t)=>{let n=document.querySelector('[data-element="page-index"]');if(!n)return;let r=n.parentElement;n.remove();for(let o=e;o<=t;o++)r.append(h(o,n))},D=({type:e,title:t,url:n,preview:r,p_date:o,org:s},T)=>{let a=l(T),v=a.querySelector('[data-element="news-type"]'),p=a.querySelector('[data-element="news-title"]'),b=a.querySelector('[data-element="news-preview'),E=a.querySelector('[data-element="news-org"]'),g=a.querySelector('[data-element="news-date"]');return v&&(v.textContent=e),p&&(p.textContent=t,p.href=n),b&&(b.textContent=r),E&&(E.textContent=s),g&&(g.textContent=o),a.removeAttribute("data-cloak"),a},d=async e=>{if(e<1||e>i)return;let t=await y(`http://metro-info.edwardxwliu.cn:5000/search?page=${e}&per_page=${S}`);if(!t){window.location.replace("/");return}let n=document.querySelector('[data-element="news-item"]');if(!n)return;let r=n.parentElement,o=t.map(s=>D(s,n));u&&u.map(s=>r.removeChild(s)),r.append(...o),u=o,N(e),m=e};function N(e){e+4>i?(w(e),c(i-9,i)):e>6?(w(e),c(e-5,e+4)):e<=6&&(w(e),c(1,10)),f(e),e!==m&&x(m),e===1?f(0):x(0),e===i?f(-1):x(-1)}var f=e=>{let t=document.querySelector(`[page-nav-index="${e}"]`);t?.classList.add("page-index_active"),t&&(t.disabled=!0)},x=e=>{let t=document.querySelector(`[page-nav-index="${e}"]`);t?.classList.remove("page-index_active"),t&&(t.disabled=!1)},H=e=>{document.querySelector(`[page-nav-index="${e}"]`)?.remove()},w=e=>{let t=document.querySelector('[data-element="page-index-wrap"]');if(!t)return;let n=t.firstElementChild?.getAttribute("page-nav-index"),r=t.lastElementChild?.getAttribute("page-nav-index");if(n&&r)for(let o=+n;o<=+r;o++)o!==e&&H(o)};})();
