"use strict";(()=>{var x=(e,t=!0)=>e.cloneNode(t);async function w(e){try{let t=await fetch(e);return t.ok?await t.json():[]}catch{return[]}}function v(){let e=Date.now(),t=new Date(e),o=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${t.getFullYear()}-${o}-${r}`}var T=1,$=1,g=10,D=v(),h=class{constructor(t){this.variables={};this.variables=t}setValue(t,o){t in this.variables?this.variables[t]=o:console.log(`No such variable '${t}' found`)}getValue(t){return this.variables[t]}},p=new h({fgwTotItems:0,wechatTotItems:0,fgwOldItemsHistory:[],fgwOldItemsToday:[],wechatOldItemsHistory:[],wechatOldItemsToday:[]});window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{y("fgw","fgwTotItems","fgwOldItemsToday","fgwOldItemsHistory"),y("wechat","wechatTotItems","wechatOldItemsToday","wechatOldItemsHistory")});async function y(e,t,o,r){let n=await w(`http://localhost:5000/stat?key=${e}&per_page=${g}`);p.setValue(t,n[0].tot_items),b(e,T,o,r),setInterval(()=>H(e,t,o,r),5e3)}async function H(e,t,o,r){if($===1){let s=(await w(`http://localhost:5000/stat?key=${e}&per_page=${g}`))[0].tot_items,l=p.getValue(t);s!==l&&(p.setValue(t,s),b(e,T,o,r))}}var E=(e,{type:t,title:o,pic_url:r,url:n,p_date:s},l)=>{let a=x(l),d=a.querySelector(`[data-element="${e}-type"]`),f=a.querySelector(`[data-element="${e}-title"]`),i=a.querySelector(`[data-element="${e}-date"]`),m=a.querySelector(`[data-element="${e}-img-preview"]`);return d&&(d.textContent=t),f&&(f.textContent=o,f.href=n),i&&(i.textContent=s),m&&(m.src=r),a.removeAttribute("data-cloak"),a},b=async(e,t,o,r)=>{if($=t,t<1)return;let n=await w(`http://localhost:5000/search?key=${e}&page=${t}&per_page=${g}&date=${D}&today=1`),s=await w(`http://localhost:5000/search?key=${e}&page=${t}&per_page=${g}&date=${D}`);if(!s){window.location.replace("/");return}let l=document.querySelector(`[data-element="${e}-item-today"]`),a=document.querySelector(`[data-element="${e}-item-history"]`),d=document.querySelector(`[data-element="${e}-more-today"]`),f=document.querySelector(`[data-element="${e}-more-history"]`);if(!(!l||!a||!d||!f)){if(d.hidden=n.length<10,n.length>0){let i=l.parentElement,m=n.map(c=>E(e,c,l)),u=p.getValue(o);u&&u.map(c=>i.removeChild(c)),i.append(...m),p.setValue(o,m)}if(s.length>0){let i=a.parentElement,m=s.map(c=>E(e,c,a)),u=p.getValue(r);u&&u.map(c=>i.removeChild(c)),i.append(...m),p.setValue(r,m)}T=t}};})();
